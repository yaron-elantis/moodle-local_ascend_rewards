{"version":3,"file":"avatar_section.min.js","sources":["../src/avatar_section.js"],"sourcesContent":["import ModalFactory from 'core/modal_factory';\nimport ModalEvents from 'core/modal_events';\nimport {\n    init as initAvatarModals,\n    showAvatarUnlockModal,\n    showAvatarReviewModal,\n    showPetUnlockModal,\n    showPetReviewModal,\n    showVillainUnlockModal,\n    showVillainReviewModal\n} from 'local_ascend_rewards/avatar_modals';\n\nconst VIDEO_MAP = {\n    'amazon.png': 'amazon.mp4',\n    'elf.png': 'elf.mp4',\n    'ent.png': 'ent.mp4',\n    'guardian.png': 'guardian.mp4',\n    'imp.png': 'imp.mp4',\n    'jester.png': 'jester.mp4',\n    'magician.png': 'magician.mp4',\n    'mermaid.png': 'mermaid.mp4',\n    'nomad.png': 'nomad.mp4',\n    'philosopher.png': 'philosopher.mp4',\n    'pirate.png': 'pirate.mp4',\n    'queen.png': 'queen.mp4',\n    'sorceress.png': 'sorceress.mp4',\n    'viking.png': 'viking.mp4',\n    'warrior.png': 'warrior.mp4',\n    'wizard.png': 'wizard.mp4',\n    'maori.png': 'maori.mp4',\n    'zulu.png': 'zulu.mp4',\n    'sentinel.png': 'sentinel.mp4',\n    'kapu.png': 'kapu.mp4',\n    'beserker.png': 'beserker.mp4'\n};\n\nconst PET_VIDEO_MAP = {\n    100: 'lynx.mp4',\n    101: 'tortoise.mp4',\n    102: 'hamster.mp4',\n    103: 'falcon.mp4',\n    104: 'gryphon.mp4',\n    105: 'boar.mp4',\n    106: 'viper.mp4',\n    107: 'swan.mp4',\n    108: 'mischiefcap.mp4',\n    109: 'otter.mp4',\n    110: 'kinkajou.mp4',\n    111: 'seahorse.mp4',\n    112: 'dragon.mp4',\n    113: 'mastiff.mp4',\n    114: 'raven.mp4',\n    115: 'tiger.mp4',\n    116: 'wolf.mp4',\n    117: 'polar_bear.mp4',\n    200: 'cheetah_bros.mp4',\n    201: 'monkey.mp4',\n    202: 'heron.mp4'\n};\n\nconst VILLAIN_VIDEO_MAP = {\n    'elf_dryad': 'elf_dryad.mp4',\n    'ent_blightmind': 'ent_blightmind.mp4',\n    'jester_mourner': 'jester_mourner.mp4',\n    'magician_spellbreaker': 'magician_spellbreaker.mp4',\n    'nomad_dune': 'nomad_dune.mp4',\n    'philosopher_mirror': 'philosopher_mirror.mp4',\n    'mermaid_duchess': 'mermaid_duchess.mp4',\n    'warrior_warlord': 'warrior_warlord.mp4',\n    'sorceress_stormveil': 'sorceress_stormveil.mp4',\n    'gatekeeper_wraith': 'gatekeeper_wraith.mp4',\n    'viking_betrayer': 'viking_betrayer.mp4',\n    'pirate_barron': 'pirate_barron.mp4',\n    'amazon_huntsmistress': 'amazon_huntsmistress.mp4',\n    'imp_mole': 'imp_mole.mp4',\n    'wizard_pale_scholar': 'wizard_pale_scholar.mp4',\n    'maori_shaman': 'maori_shaman.mp4',\n    'zulu_witchdoctor': 'zulu_witchdoctor.mp4',\n    'sentinel_void': 'sentinel_void.mp4',\n    'kapu_judge': 'kapu_judge.mp4'\n};\n\nconst applyDataStyles = () => {\n    document.querySelectorAll('[data-header-color]').forEach((el) => {\n        const color = el.getAttribute('data-header-color');\n        if (color) {\n            el.style.color = color;\n        }\n    });\n\n    document.querySelectorAll('.avatar-level-content[data-content-opacity]').forEach((el) => {\n        const opacity = el.getAttribute('data-content-opacity');\n        const pointer = el.getAttribute('data-content-pointer');\n        if (opacity !== null && opacity !== '') {\n            el.style.opacity = opacity;\n        }\n        if (pointer) {\n            el.style.pointerEvents = pointer;\n        }\n    });\n\n    document.querySelectorAll('[data-font-family]').forEach((el) => {\n        const fontFamily = el.getAttribute('data-font-family');\n        if (fontFamily) {\n            el.style.fontFamily = fontFamily;\n        }\n    });\n\n    document.querySelectorAll('[data-filter]').forEach((el) => {\n        const filter = el.getAttribute('data-filter');\n        if (filter) {\n            el.style.filter = filter;\n        }\n    });\n\n    document.querySelectorAll('[data-cursor]').forEach((el) => {\n        const cursor = el.getAttribute('data-cursor');\n        if (cursor) {\n            el.style.cursor = cursor;\n        }\n    });\n\n    document.querySelectorAll('[data-coin-size]').forEach((el) => {\n        const size = el.getAttribute('data-coin-size');\n        if (size) {\n            el.style.width = size;\n        }\n    });\n};\n\nconst openStoryModal = async (title, youtubeId) => {\n    if (!youtubeId) {\n        return;\n    }\n\n    const modal = await ModalFactory.create({\n        type: ModalFactory.types.DEFAULT,\n        title: title,\n        body: `<div class=\"aa-youtube-modal-body\">\n            <iframe\n                width=\"100%\"\n                height=\"600\"\n                src=\"https://www.youtube-nocookie.com/embed/${encodeURIComponent(youtubeId)}?autoplay=1&rel=0&modestbranding=1&fs=1\"\n                title=\"${title}\"\n                frameborder=\"0\"\n                allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture\"\n                allowfullscreen\n                class=\"aa-youtube-modal-iframe\">\n            </iframe>\n        </div>`\n    });\n\n    modal.getRoot().addClass('aa-youtube-modal');\n    modal.show();\n\n    modal.getRoot().on(ModalEvents.hidden, () => {\n        modal.destroy();\n    });\n};\n\nexport const init = (config) => {\n    if (!document.querySelector('#a_avatars')) {\n        return;\n    }\n\n    const tokensAvailable = Number(config?.tokensAvailable ?? 0);\n    const coinBalance = Number(config?.coinBalance ?? 0);\n    const storyFallbackTitle = config?.storyFallbackTitle || '';\n    const modalStrings = config?.modalStrings || {};\n\n    initAvatarModals({strings: modalStrings});\n\n    applyDataStyles();\n\n    document.querySelectorAll('.avatar-card').forEach((card) => {\n        card.addEventListener('click', () => {\n            const avatar = card.getAttribute('data-avatar');\n            const name = card.getAttribute('data-name');\n            const level = Number(card.getAttribute('data-level') || 0);\n            const isUnlocked = card.classList.contains('unlocked');\n            const videoFile = VIDEO_MAP[avatar] || 'elf.mp4';\n\n            if (isUnlocked) {\n                showAvatarReviewModal(avatar, name, videoFile);\n                return;\n            }\n            showAvatarUnlockModal(name, avatar, videoFile, level, tokensAvailable);\n        });\n    });\n\n    document.querySelectorAll('.pet-card').forEach((card) => {\n        card.addEventListener('click', () => {\n            const petId = Number(card.getAttribute('data-pet-id'));\n            const petName = card.getAttribute('data-pet-name');\n            const petPrice = Number(card.getAttribute('data-pet-price'));\n            const canUnlock = card.getAttribute('data-can-unlock') === '1';\n            const isOwned = card.classList.contains('owned');\n            const petVideo = PET_VIDEO_MAP[petId] || 'lynx.mp4';\n\n            if (isOwned) {\n                showPetReviewModal(petName, petId, petVideo);\n                return;\n            }\n            if (!canUnlock) {\n                return;\n            }\n            showPetUnlockModal(petId, petName, petPrice, petVideo, tokensAvailable, coinBalance);\n        });\n    });\n\n    document.querySelectorAll('.villain-card').forEach((card) => {\n        card.addEventListener('click', () => {\n            const villainId = Number(card.getAttribute('data-villain-id'));\n            const villainName = card.getAttribute('data-villain-name');\n            const villainPrice = Number(card.getAttribute('data-villain-price'));\n            const villainImageName = card.getAttribute('data-villain-icon');\n            const canUnlock = card.getAttribute('data-can-unlock') === '1';\n            const isOwned = card.classList.contains('owned');\n            const videoKey = villainImageName ? villainImageName.replace('.png', '') : '';\n            const villainVideo = VILLAIN_VIDEO_MAP[videoKey] || 'elf_dryad.mp4';\n\n            if (isOwned) {\n                showVillainReviewModal(villainName, villainId, villainImageName, villainVideo);\n                return;\n            }\n            if (!canUnlock) {\n                return;\n            }\n            showVillainUnlockModal(\n                villainId,\n                villainName,\n                villainPrice,\n                villainImageName,\n                villainVideo,\n                tokensAvailable,\n                coinBalance\n            );\n        });\n    });\n\n    document.querySelectorAll('.watch-story-btn').forEach((btn) => {\n        btn.addEventListener('click', () => {\n            const youtubeId = btn.getAttribute('data-youtube-id');\n            const setName = btn.getAttribute('data-set-name') || btn.textContent || '';\n            const fallbackTitle = storyFallbackTitle || setName || '';\n            openStoryModal(setName.trim() || fallbackTitle || '', youtubeId);\n        });\n    });\n};\n"],"names":["VIDEO_MAP","PET_VIDEO_MAP","VILLAIN_VIDEO_MAP","config","document","querySelector","tokensAvailable","Number","coinBalance","storyFallbackTitle","modalStrings","strings","querySelectorAll","forEach","el","color","getAttribute","style","opacity","pointer","pointerEvents","fontFamily","filter","cursor","size","width","card","addEventListener","avatar","name","level","isUnlocked","classList","contains","videoFile","petId","petName","petPrice","canUnlock","isOwned","petVideo","villainId","villainName","villainPrice","villainImageName","videoKey","replace","villainVideo","btn","youtubeId","setName","textContent","fallbackTitle","async","title","modal","ModalFactory","create","type","types","DEFAULT","body","encodeURIComponent","getRoot","addClass","show","on","ModalEvents","hidden","destroy","openStoryModal","trim"],"mappings":"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"}