{"version":3,"file":"store_section.min.js","sources":["../src/store_section.js"],"sourcesContent":["import Ajax from 'core/ajax';\nimport Notification from 'core/notification';\nimport {\n    init as initAvatarModals,\n    showPetUnlockModal,\n    showVillainUnlockModal\n} from 'local_ascend_rewards/avatar_modals';\n\nconst PET_VIDEO_MAP = {\n    100: 'lynx.mp4',\n    101: 'tortoise.mp4',\n    102: 'hamster.mp4',\n    103: 'falcon.mp4',\n    104: 'gryphon.mp4',\n    105: 'boar.mp4',\n    106: 'viper.mp4',\n    107: 'swan.mp4',\n    108: 'mischiefcap.mp4',\n    109: 'otter.mp4',\n    110: 'kinkajou.mp4',\n    111: 'seahorse.mp4',\n    112: 'dragonet.mp4',\n    113: 'mastiff.mp4',\n    114: 'raven.mp4',\n    115: 'tiger.mp4',\n    116: 'wolf.mp4',\n    117: 'polar_bear.mp4'\n};\n\nconst VILLAIN_VIDEO_MAP = {\n    'elf_dryad': 'elf_dryad.mp4',\n    'ent_blightmind': 'ent_blightmind.mp4',\n    'jester_mourner': 'jester_mourner.mp4',\n    'magician_spellbreaker': 'magician_spellbreaker.mp4',\n    'nomad_dune': 'nomad_dune.mp4',\n    'philosopher_mirror': 'philosopher_mirror.mp4',\n    'mermaid_duchess': 'mermaid_duchess.mp4',\n    'warrior_warlord': 'warrior_warlord.mp4',\n    'sorceress_stormveil': 'sorceress_stormveil.mp4',\n    'gatekeeper_wraith': 'gatekeeper_wraith.mp4',\n    'viking_betrayer': 'viking_betrayer.mp4',\n    'pirate_barron': 'pirate_barron.mp4',\n    'amazon_huntsmistress': 'amazon_huntsmistress.mp4',\n    'imp_mole': 'imp_mole.mp4',\n    'wizard_pale_scholar': 'wizard_pale_scholar.mp4',\n    'maori_shaman': 'maori_shaman.mp4',\n    'zulu_witchdoctor': 'zulu_witchdoctor.mp4',\n    'sentinel_void': 'sentinel_void.mp4',\n    'kapu_judge': 'kapu_judge.mp4'\n};\n\nlet ajaxRequestFailed = '';\n\nconst callAjax = (methodname, args) => {\n    const requests = Ajax.call([{methodname, args}]);\n    return requests && requests[0]\n        ? requests[0]\n        : Promise.reject(new Error(ajaxRequestFailed || ''));\n};\n\nconst showAlert = (strings, message, isError = false) => {\n    if (!message) {\n        return;\n    }\n    const title = isError ? strings.errorTitle : strings.alertTitle;\n    Notification.alert(title || '', message, strings.closeLabel || '');\n};\n\nconst confirmAction = async(strings, message, triggerElement) => {\n    if (!message) {\n        return false;\n    }\n\n    if (typeof Notification.saveCancelPromise === 'function') {\n        try {\n            await Notification.saveCancelPromise(\n                strings.confirmTitle || strings.alertTitle || '',\n                message,\n                strings.purchaseConfirmActionLabel || strings.confirmActionLabel || '',\n                {triggerElement}\n            );\n            return true;\n        } catch (error) {\n            return false;\n        }\n    }\n\n    return window.confirm(message);\n};\n\n\nconst initXpMultiplierTimer = (strings) => {\n    const timerEl = document.getElementById('xpMultiplierTimer_store');\n    if (!timerEl) {\n        return;\n    }\n\n    const updateTimer = () => {\n        const expiresAt = parseInt(timerEl.getAttribute('data-expires') || '0', 10);\n        const now = Math.floor(Date.now() / 1000);\n        const remaining = expiresAt - now;\n\n        if (remaining <= 0) {\n            timerEl.textContent = strings.expiredLabel;\n            return;\n        }\n\n        const hours = Math.floor(remaining / 3600);\n        const minutes = Math.floor((remaining % 3600) / 60);\n        const seconds = remaining % 60;\n\n        timerEl.textContent = `${hours}h ${minutes}m ${seconds}s`;\n    };\n\n    updateTimer();\n    setInterval(updateTimer, 1000);\n};\n\nconst initStorePurchases = (strings) => {\n    const storeBuyBtns = document.querySelectorAll('.store-buy-btn:not(.pet-buy-btn):not(.villain-buy-btn)');\n    storeBuyBtns.forEach((btn) => {\n        btn.addEventListener('click', async() => {\n            const itemId = btn.getAttribute('data-item-id');\n            const itemName = btn.getAttribute('data-item-name');\n            const itemPrice = btn.getAttribute('data-item-price');\n\n            const confirmMessage = `${strings.purchaseConfirmPrefix}${itemName}${strings.purchaseConfirmMid}${itemPrice}${strings.purchaseConfirmSuffix}`;\n            const confirmed = await confirmAction(strings, confirmMessage, btn);\n            if (!confirmed) {\n                return;\n            }\n\n            btn.disabled = true;\n            btn.textContent = strings.processingLabel;\n\n            callAjax('local_ascend_rewards_store_purchase', {item_id: parseInt(itemId, 10)})\n                .then((result) => {\n                    if (result && result.success) {\n                        showAlert(\n                            strings,\n                            `${strings.purchaseSuccessLabel}\\n\\n${strings.remainingBalanceLabel} ${result.remaining_coins.toLocaleString()} ${strings.coinsLabel}`\n                        );\n                        window.location.reload();\n                        return;\n                    }\n\n                    showAlert(\n                        strings,\n                        `${strings.errorPrefix || \"\"}${(result && result.error) || strings.purchaseErrorLabel}`,\n                        true\n                    );\n                    btn.disabled = false;\n                    btn.textContent = `${strings.purchaseButtonPrefix}${itemPrice} ${strings.coinsLabel}`;\n                })\n                .catch(() => {\n                    showAlert(strings, strings.purchaseProcessingErrorLabel, true);\n                    btn.disabled = false;\n                    btn.textContent = `${strings.purchaseButtonPrefix}${itemPrice} ${strings.coinsLabel}`;\n                });\n        });\n    });\n};\n\nconst initStoreActivation = (strings) => {\n    document.querySelectorAll('.store-activate-btn').forEach((btn) => {\n        btn.addEventListener('click', () => {\n            const itemId = parseInt(btn.getAttribute('data-item-id') || '0', 10);\n\n            btn.disabled = true;\n            btn.textContent = strings.processingLabel;\n\n            callAjax('local_ascend_rewards_store_activate', {item_id: itemId})\n                .then((result) => {\n                    if (result && result.success) {\n                        showAlert(strings, result.message);\n                        window.location.reload();\n                        return;\n                    }\n\n                    showAlert(\n                        strings,\n                        `${strings.errorPrefix || \"\"}${(result && result.error) || strings.activationErrorLabel}`,\n                        true\n                    );\n                    btn.disabled = false;\n                    btn.textContent = strings.activateLabel;\n                })\n                .catch(() => {\n                    showAlert(strings, strings.activationProcessingErrorLabel, true);\n                    btn.disabled = false;\n                    btn.textContent = strings.activateLabel;\n                });\n        });\n    });\n};\n\nconst initPetPurchases = (tokensAvailable, coinBalance, strings) => {\n    document.querySelectorAll('.pet-buy-btn').forEach((btn) => {\n        btn.addEventListener('click', () => {\n            const petId = parseInt(btn.getAttribute('data-item-id') || '0', 10);\n            const petName = btn.getAttribute('data-item-name');\n            const petPrice = parseInt(btn.getAttribute('data-item-price') || '0', 10);\n            const petVideo = PET_VIDEO_MAP[petId] || 'lynx.mp4';\n\n            showPetUnlockModal(petId, petName, petPrice, petVideo, tokensAvailable, coinBalance);\n        });\n    });\n\n    document.querySelectorAll('.store-frame-pet').forEach((frame) => {\n        frame.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' || e.key === ' ') {\n                e.preventDefault();\n                const btn = frame.closest('.store-card').querySelector('.pet-buy-btn');\n                if (btn && !btn.disabled) {\n                    btn.click();\n                }\n            }\n        });\n        frame.addEventListener('click', () => {\n            const btn = frame.closest('.store-card').querySelector('.pet-buy-btn');\n            if (btn && !btn.disabled) {\n                btn.click();\n            }\n        });\n    });\n};\n\nconst initVillainPurchases = (tokensAvailable, coinBalance) => {\n    document.querySelectorAll('.villain-buy-btn').forEach((btn) => {\n        btn.addEventListener('click', () => {\n            const villainId = parseInt(btn.getAttribute('data-item-id') || '0', 10);\n            const villainName = btn.getAttribute('data-item-name');\n            const villainPrice = parseInt(btn.getAttribute('data-item-price') || '0', 10);\n            const villainIconName = btn.getAttribute('data-villain-icon') || '';\n            const videoKey = villainIconName.replace('.png', '');\n            const villainVideo = VILLAIN_VIDEO_MAP[videoKey] || 'elf_dryad.mp4';\n\n            showVillainUnlockModal(\n                villainId,\n                villainName,\n                villainPrice,\n                villainIconName,\n                villainVideo,\n                tokensAvailable,\n                coinBalance\n            );\n        });\n    });\n\n    document.querySelectorAll('.store-frame-villain').forEach((frame) => {\n        frame.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter' || e.key === ' ') {\n                e.preventDefault();\n                const btn = frame.closest('.store-card').querySelector('.villain-buy-btn');\n                if (btn && !btn.disabled) {\n                    btn.click();\n                }\n            }\n        });\n        frame.addEventListener('click', () => {\n            const btn = frame.closest('.store-card').querySelector('.villain-buy-btn');\n            if (btn && !btn.disabled) {\n                btn.click();\n            }\n        });\n    });\n};\n\nconst initMysteryBox = (strings, urls) => {\n    const mysteryBtns = document.querySelectorAll('.mysterybox-open-btn');\n    const mysteryModal = document.getElementById('mysteryBoxModal');\n    const boxesContainer = document.getElementById('boxesContainer');\n    const resultDisplay = document.getElementById('resultDisplay');\n    const resultMessage = document.getElementById('resultMessage');\n    const resultIcon = document.getElementById('resultIcon');\n    const closeModalBtn = document.getElementById('closeModalBtn');\n\n    if (!mysteryBtns.length) {\n        return;\n    }\n\n    mysteryBtns.forEach((btn) => {\n        btn.addEventListener('click', () => {\n            const price = parseInt(btn.getAttribute('data-price') || '50', 10);\n\n            if (mysteryModal) {\n                mysteryModal.style.display = 'flex';\n                if (boxesContainer) {\n                    boxesContainer.style.display = 'none';\n                }\n                if (resultDisplay) {\n                    resultDisplay.style.display = 'block';\n                }\n            }\n\n            btn.disabled = true;\n            const originalText = btn.textContent;\n            btn.textContent = strings.mysteryOpeningLabel;\n\n            callAjax('local_ascend_rewards_mysterybox_open', {price: price})\n                .then((result) => {\n                    if (!result || !result.success) {\n                        if (mysteryModal) {\n                            mysteryModal.style.display = 'none';\n                        }\n                        const message = (result && result.message) || strings.mysteryErrorCouldNotOpen;\n                        showAlert(strings, `${strings.errorPrefix || ''}${message}`, true);\n                        btn.disabled = false;\n                        btn.textContent = originalText;\n                        return;\n                    }\n\n                    const cacheBust = `?v=${Date.now()}`;\n                    const videos = {\n                        coins: `${urls.videoCoinsUrl}${cacheBust}`,\n                        coins_duplicate: `${urls.videoCoinsUrl}${cacheBust}`,\n                        tokens: `${urls.videoTokensUrl}${cacheBust}`,\n                        avatar_new: `${urls.videoHeroUrl}${cacheBust}`,\n                        avatar_duplicate: `${urls.videoHeroUrl}${cacheBust}`,\n                        avatar_locked_level: `${urls.videoHeroUrl}${cacheBust}`,\n                        nothing: `${urls.videoNoRewardUrl}${cacheBust}`\n                    };\n\n                    const videoUrl = videos[result.reward_type] || `${urls.videoNoRewardUrl}${cacheBust}`;\n\n                    let resultHTML = `<video autoplay playsinline preload=\"auto\" crossorigin=\"anonymous\" class=\"mystery-result-video\" id=\"rewardVideo\"><source src=\"${videoUrl}\" type=\"video/mp4\"></video>`;\n                    resultIcon.innerHTML = resultHTML;\n\n                    let messageHTML = '';\n                    let balanceHTML = '';\n\n                    if (result.reward_type === 'tokens') {\n                        messageHTML = `<div class=\"mystery-result-media\"><img src=\"${urls.imgStarUrl}\" class=\"mystery-result-icon-image mystery-result-icon-image--star\"></div>` +\n                            `<div>${result.message}</div>`;\n                        balanceHTML = `<div class=\"mystery-balance\">${strings.newBalanceLabel} <img src=\"${urls.imgStarUrl}\" class=\"mystery-balance-icon mystery-balance-icon--star\">${result.total_tokens} ${strings.tokensLabel}</div>`;\n                    } else if (result.reward_type === 'coins' || result.reward_type === 'coins_duplicate') {\n                        messageHTML = `<div class=\"mystery-result-media\"><img src=\"${urls.imgCoinsUrl}\" class=\"mystery-result-icon-image mystery-result-icon-image--coins\"></div>` +\n                            `<div>${result.message}</div>`;\n                        balanceHTML = `<div class=\"mystery-balance\">${strings.newBalanceLabel} <img src=\"${urls.imgCoinsUrl}\" class=\"mystery-balance-icon mystery-balance-icon--coins\">${result.new_balance.toLocaleString()} ${strings.coinsLabel}</div>`;\n                    } else if (result.reward_type === 'avatar_duplicate' || result.reward_type === 'avatar_locked_level') {\n                        messageHTML = `<div>${result.message}</div>`;\n                        balanceHTML = `<div class=\"mystery-balance\">${strings.newBalanceLabel} <img src=\"${urls.imgCoinsUrl}\" class=\"mystery-balance-icon mystery-balance-icon--coins\">${result.new_balance.toLocaleString()} ${strings.coinsLabel}</div>`;\n                    } else if (result.reward_type === 'avatar_new') {\n                        messageHTML = `<div>${result.message}</div>`;\n                    } else {\n                        messageHTML = result.message;\n                        balanceHTML = `<div class=\"mystery-balance\">${strings.balanceLabel} <img src=\"${urls.imgCoinsUrl}\" class=\"mystery-balance-icon mystery-balance-icon--coins\">${result.new_balance.toLocaleString()} ${strings.coinsLabel}</div>`;\n                    }\n\n                    resultMessage.innerHTML = messageHTML + balanceHTML;\n\n                    if ((result.reward_type === 'avatar_new' || result.reward_type === 'avatar_duplicate') &&\n                        result.reward_data &&\n                        result.reward_data.avatar_filename) {\n                        const avatarUrl = `${urls.avatarCircularBaseUrl}${result.reward_data.avatar_filename}`;\n                        resultHTML += `<div class=\"mystery-avatar-reward\" id=\"avatarReward\"><img src=\"${avatarUrl}\" alt=\"${strings.avatarAltLabel || \"\"}\" class=\"mystery-avatar-image\"></div>`;\n                        resultIcon.innerHTML = resultHTML;\n                    }\n\n                    const video = document.getElementById('rewardVideo');\n                    if (video) {\n                        video.addEventListener('error', () => {\n                            resultMessage.classList.add('animate-slide-in');\n                            resultMessage.style.opacity = '1';\n                            closeModalBtn.style.opacity = '1';\n\n                            const avatarReward = document.getElementById('avatarReward');\n                            if (avatarReward) {\n                                const avatarImg = avatarReward.querySelector('img');\n                                if (avatarImg) {\n                                    avatarImg.classList.add('animate-bounce-in');\n                                    avatarImg.style.opacity = '1';\n                                }\n                            }\n                        });\n\n                        video.addEventListener('ended', () => {\n                            resultMessage.classList.add('animate-slide-in');\n                            resultMessage.style.opacity = '1';\n\n                            setTimeout(() => {\n                                closeModalBtn.style.opacity = '1';\n                            }, 300);\n\n                            const avatarReward = document.getElementById('avatarReward');\n                            if (avatarReward) {\n                                const avatarImg = avatarReward.querySelector('img');\n                                if (avatarImg) {\n                                    avatarImg.classList.add('animate-bounce-in');\n                                    avatarImg.style.opacity = '1';\n                                }\n                            }\n                        });\n\n                        setTimeout(() => {\n                            if (!resultMessage.style.opacity || resultMessage.style.opacity === '0') {\n                                resultMessage.classList.add('animate-slide-in');\n                                resultMessage.style.opacity = '1';\n                                closeModalBtn.style.opacity = '1';\n\n                                const avatarReward = document.getElementById('avatarReward');\n                                if (avatarReward) {\n                                    const avatarImg = avatarReward.querySelector('img');\n                                    if (avatarImg && avatarImg.style.opacity === '0') {\n                                        avatarImg.classList.add('animate-bounce-in');\n                                        avatarImg.style.opacity = '1';\n                                    }\n                                }\n                            }\n                        }, 5000);\n                    }\n\n                    btn.disabled = false;\n                    btn.textContent = originalText;\n                })\n                .catch((error) => {\n                    // eslint-disable-next-line no-console\n                    console.error('Error opening mystery box:', error);\n                    if (boxesContainer) {\n                        boxesContainer.style.display = 'none';\n                    }\n                    if (resultDisplay) {\n                        resultDisplay.style.display = 'block';\n                    }\n                    resultIcon.innerHTML = `<video autoplay loop playsinline class=\"mystery-result-video mystery-result-video--fallback\"><source src=\"${urls.videoNoRewardUrl}\" type=\"video/mp4\"></video>`;\n                    resultMessage.textContent = strings.mysteryErrorProcessing;\n                    resultMessage.classList.add('animate-slide-in');\n                    resultMessage.style.opacity = '1';\n                    if (closeModalBtn) {\n                        closeModalBtn.style.opacity = '1';\n                    }\n                    btn.disabled = false;\n                    btn.textContent = originalText;\n                });\n        });\n    });\n\n    if (closeModalBtn) {\n        closeModalBtn.addEventListener('click', () => {\n            if (mysteryModal) {\n                mysteryModal.style.display = 'none';\n                window.location.reload();\n            }\n        });\n    }\n};\n\nexport const init = (config) => {\n    if (!document.querySelector('#a_store')) {\n        return;\n    }\n\n    const tokensAvailable = Number((config && config.tokensAvailable) || 0);\n    const coinBalance = Number((config && config.coinBalance) || 0);\n    const strings = (config && config.strings) || {};\n    const urls = (config && config.urls) || {};\n    const modalStrings = (config && config.modalStrings) || {};\n\n    initAvatarModals({strings: modalStrings});\n\n    ajaxRequestFailed = strings.ajaxRequestFailed || '';\n\n    initXpMultiplierTimer(strings);\n    initStorePurchases(strings);\n    initStoreActivation(strings);\n    initPetPurchases(tokensAvailable, coinBalance, strings);\n    initVillainPurchases(tokensAvailable, coinBalance);\n    initMysteryBox(strings, urls);\n};\n"],"names":["PET_VIDEO_MAP","VILLAIN_VIDEO_MAP","ajaxRequestFailed","callAjax","methodname","args","requests","Ajax","call","Promise","reject","Error","showAlert","strings","message","isError","title","errorTitle","alertTitle","alert","closeLabel","initStorePurchases","document","querySelectorAll","forEach","btn","addEventListener","async","itemId","getAttribute","itemName","itemPrice","confirmMessage","purchaseConfirmPrefix","purchaseConfirmMid","purchaseConfirmSuffix","confirmed","triggerElement","Notification","saveCancelPromise","confirmTitle","purchaseConfirmActionLabel","confirmActionLabel","error","window","confirm","confirmAction","disabled","textContent","processingLabel","item_id","parseInt","then","result","success","purchaseSuccessLabel","remainingBalanceLabel","remaining_coins","toLocaleString","coinsLabel","location","reload","errorPrefix","purchaseErrorLabel","purchaseButtonPrefix","catch","purchaseProcessingErrorLabel","config","querySelector","tokensAvailable","Number","coinBalance","urls","modalStrings","timerEl","getElementById","updateTimer","remaining","Math","floor","Date","now","expiredLabel","hours","minutes","seconds","setInterval","initXpMultiplierTimer","activationErrorLabel","activateLabel","activationProcessingErrorLabel","initStoreActivation","petId","petName","petPrice","petVideo","frame","e","key","preventDefault","closest","click","initPetPurchases","villainId","villainName","villainPrice","villainIconName","videoKey","replace","villainVideo","initVillainPurchases","mysteryBtns","mysteryModal","boxesContainer","resultDisplay","resultMessage","resultIcon","closeModalBtn","length","price","style","display","originalText","mysteryOpeningLabel","mysteryErrorCouldNotOpen","cacheBust","videoUrl","coins","videoCoinsUrl","coins_duplicate","tokens","videoTokensUrl","avatar_new","videoHeroUrl","avatar_duplicate","avatar_locked_level","nothing","videoNoRewardUrl","reward_type","resultHTML","innerHTML","messageHTML","balanceHTML","imgStarUrl","newBalanceLabel","total_tokens","tokensLabel","imgCoinsUrl","new_balance","balanceLabel","reward_data","avatar_filename","avatarUrl","avatarCircularBaseUrl","avatarAltLabel","video","classList","add","opacity","avatarReward","avatarImg","setTimeout","console","mysteryErrorProcessing","initMysteryBox"],"mappings":"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"}