define("local_ascend_rewards/notifications",["exports","core/ajax"],(function(_exports,_ajax){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_ajax=(obj=_ajax)&&obj.__esModule?obj:{default:obj};const callAjax=(methodname,args)=>{const requests=_ajax.default.call([{methodname:methodname,args:args}]);return requests&&requests[0]?requests[0]:Promise.reject(new Error)};_exports.init=()=>{const levelup=(()=>{const backdrop=document.getElementById("apexLevelupBackdrop"),modal=document.getElementById("apexLevelupModal"),video=document.getElementById("apexLevelupVideo"),sound=document.getElementById("apexLevelupSound"),closeBtn=document.getElementById("apexLevelupClose");if(!backdrop||!modal)return{exists:!1,show:()=>{}};let loopCount=0;const closeModal=()=>{modal.style.display="none",backdrop.style.display="none",video&&(video.pause(),video.currentTime=0,loopCount=0),checkForMoreLevelups()},checkForMoreLevelups=()=>{callAjax("local_ascend_rewards_check_levelups",{}).then((response=>{response.has_more&&setTimeout((()=>{window.location.reload()}),300)})).catch((()=>{}))};return video&&video.addEventListener("ended",(()=>{loopCount+=1,loopCount<3&&(video.currentTime=0,video.play().catch((()=>{})))})),closeBtn&&closeBtn.addEventListener("click",closeModal),backdrop.addEventListener("click",closeModal),setTimeout((()=>{closeModal()}),25e3),{exists:!0,show:()=>{backdrop.style.display="block",modal.style.display="block",video&&(loopCount=0,video.volume=.7,video.currentTime=0,video.play().catch((()=>{}))),sound&&(sound.volume=.6,sound.currentTime=0,sound.play().catch((()=>{})))}}})(),reward=(onNoMoreBadges=>{const backdrop=document.getElementById("apexRewardBackdrop"),modal=document.getElementById("apexRewardModal"),video=document.getElementById("apexRewardVideo"),fullscreenBtn=document.getElementById("apexRewardFullscreen"),closeBtn=document.getElementById("apexRewardClose");if(!backdrop||!modal)return{exists:!1,show:()=>{}};let loopCount=0;const closeModal=()=>{modal.style.display="none",backdrop.style.display="none",video&&(video.pause(),video.currentTime=0,loopCount=0),checkForMoreNotifications()},checkForMoreNotifications=()=>{callAjax("local_ascend_rewards_check_notifications",{}).then((response=>{response.has_more?setTimeout((()=>{window.location.reload()}),300):"function"==typeof onNoMoreBadges&&setTimeout(onNoMoreBadges,500)})).catch((()=>{}))};return video&&video.addEventListener("ended",(()=>{loopCount+=1,loopCount<3&&(video.currentTime=0,video.play().catch((()=>{})))})),closeBtn&&closeBtn.addEventListener("click",closeModal),backdrop.addEventListener("click",closeModal),fullscreenBtn&&video&&fullscreenBtn.addEventListener("click",(event=>{event.stopPropagation(),video.requestFullscreen?video.requestFullscreen():video.webkitRequestFullscreen?video.webkitRequestFullscreen():video.mozRequestFullScreen?video.mozRequestFullScreen():video.msRequestFullscreen&&video.msRequestFullscreen()})),setTimeout((()=>{closeModal()}),25e3),{exists:!0,show:()=>{backdrop.style.display="block",modal.style.display="block",video&&(loopCount=0,video.volume=.7,video.currentTime=0,video.play().catch((()=>{})))}}})((()=>{levelup.exists&&levelup.show()}));reward.exists?"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>reward.show()),500)})):setTimeout((()=>reward.show()),500):levelup.exists&&("loading"===document.readyState?document.addEventListener("DOMContentLoaded",(()=>{setTimeout((()=>levelup.show()),1e3)})):setTimeout((()=>levelup.show()),1e3))}}));

//# sourceMappingURL=notifications.min.js.map